# Gathering of Sample Data

The goal of this step is to take the data from Elastic and prepare them into samples that will be processed by the model for training.

To achieve the goal of overfitting the model with good data, datapoints are queried from Elastic with given timestamps corresponding to those times that have no reports of unresponsiveness and that the system is considered to be operating normally.

The code for gathering the raw data and generating the samples can be found here: [`prepare_samples.py`](../python/prepare_samples.py)

1. The raw datapoints are gathered from Elastic using a query that groups the logs of response times and computes the 95th percentile response time for every interval of 1 second.
    ```python
    raw_data = get_raw_data(start=start, end=end)
    ```

    Here's an example of data from Elastic (queried only 1 minute of data for demo purposes): [`sample_raw_data.json`](../data/sample_raw_data.json)

2. After getting the raw data, the 95th percentile response times values are then extracted.
    ```python
    raw_data = get_raw_data(start=start, end=end)
    values = extract_values(raw_data)
    ```
2. The whole dataset are then generated by sliding a window across the extracted values with window size of 180 points which is equal to 3 minutes.
    ```python
    samples = get_sliding_data(values, 180)
    ```
